<section class="client-page">
    <h1>📋 거래처 관리<span id="total-count" style="font-size:0.5em; background:#e3f2fd; color:#007bff; padding:2px 10px; border-radius:15px; vertical-align:middle; margin-left:5px;">0</span></h1>
    
    <div class="control-panel" style="display:flex; justify-content:space-between; margin-bottom:15px;">
        <button id="btn-toggle-form" class="btn-primary">➕ 신규 거래처 등록</button>
        
        <div class="search-panel-simple" style="display:flex; gap:5px;">
            <input type="text" id="search-input" placeholder="거래처명 또는 담당자 검색..." style="padding:8px; border:1px solid #ccc; border-radius:4px; width:250px;">
        </div>
    </div>

    <div id="form-panel" class="input-panel hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
            <h3 id="form-title" style="margin:0;">📝 거래처 상세 정보 입력</h3>
            <div>
                <button id="btn-save" class="btn-save">저장하기</button>
                <button id="btn-cancel" class="btn-cancel">닫기</button>
            </div>
        </div>
        
        <div class="form-group-box">
            <div class="group-title">🏢 기본 정보</div>
            <div class="grid-3">
                <div class="field">
                    <label>거래처명 <span style="color:red">*</span></label>
                    <input type="text" id="inp-name" placeholder="(주)우리회사">
                </div>
                <div class="field">
                    <label>고객번호</label>
                    <input type="text" id="inp-code" placeholder="자동 생성됨" readonly>
                </div>
                
                <div class="field">
                    <label>담당자</label>
                    <input type="text" id="inp-contact" placeholder="이름 / 연락처">
                </div>
                <div class="field">
                    <label>수취인명</label>
                    <input type="text" id="inp-recipient" placeholder="세금계산서 담당자 등">
                </div>
                <div class="field">
                    <label>수취부서(설치장소)</label>
                    <input type="text" id="inp-dept" placeholder="예: 2층 총무팀">
                </div>
            </div>
        </div>

        <div class="form-group-box">
            <div class="group-title">📅 계약 기간 및 형태</div>
            <div class="grid-4">
                <div class="field">
                    <label>계약형태</label>
                    <select id="inp-contract-type">
                        <option value="">선택하세요</option>
                        <option value="임대">임대 (렌탈)</option>
                        <option value="판매">판매 (매매)</option>
                        <option value="유지보수">유지보수</option>
                    </select>
                </div>
                <div class="field">
                    <label>계약일자</label>
                    <input type="date" id="inp-contract-date">
                </div>
                <div class="field">
                    <label>계약개시일</label>
                    <input type="date" id="inp-start-date">
                </div>
                <div class="field">
                    <label>계약만기일</label>
                    <input type="date" id="inp-end-date">
                </div>
                <div class="field">
                    <label>해약일자</label>
                    <input type="date" id="inp-cancel-date">
                </div>
            </div>
        </div>

        <div class="form-group-box">
            <div class="group-title">
                🖨️ 청구 정보 
                <span style="font-size:0.8rem; font-weight:normal; color:#e74c3c; margin-left:5px;">
                    (※ 기기별 상세 요금은 아래 '보유 기기 관리'에서 설정합니다.)
                </span>
            </div>
            
            <div class="grid-2" style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
                <div class="field">
                    <label>청구방법</label>
                    <select id="inp-bill-method">
                        <option value="">선택하세요</option>
                        <option value="월청구">월청구 (후불)</option>
                        <option value="선청구">선청구 (선불)</option>
                        <option value="수시청구">수시청구</option>
                    </select>
                </div>
                <div class="field">
                    <label>청구일</label>
                    <input type="text" id="inp-bill-day" placeholder="매월 25일 / 말일 등">
                </div>
            </div>
        </div>

        <div id="group-assets" class="form-group-box hidden">
            <div class="group-title">
                🖨️ 보유 기기 및 임대 조건 관리
                <span style="font-size:0.8rem; font-weight:normal; color:#666; margin-left:10px;">
                    (이 거래처에 설치된 기기와 요금제를 관리합니다)
                </span>
            </div>

            <div style="background:white; border:1px solid #eee; padding:10px; margin-bottom:15px; border-radius:4px;">
                <ul id="mini-asset-list" style="list-style:none; padding:0; margin:0;">
                    <li style="color:#999; text-align:center;">등록된 기기가 없습니다.</li>
                </ul>
            </div>

            <div style="background:#e3f2fd; padding:15px; border-radius:6px; border:1px solid #bbdefb;">
                <div style="display:flex; gap:10px; margin-bottom:10px;">
                    <button id="tab-stock" class="btn-tab active">📦 재고에서 가져오기</button>
                    <button id="tab-new" class="btn-tab">✨ 신규 기기 등록</button>
                </div>

                <div class="contract-settings" style="background: white; padding: 12px; border-radius: 4px; margin-bottom: 12px; border: 1px dashed #2196F3;">
                    <div style="font-weight: bold; margin-bottom: 8px; font-size: 0.9em; color: #1976D2;">💰 기기별 임대 요금 설정 (추가할 기기에 적용)</div>
                    
                    <div style="margin-bottom: 8px;">
                        <label style="font-size: 0.85em;">월 기본 렌탈료(원)</label>
                        <input type="number" id="contract-monthly-fee" placeholder="60000" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                    </div>

                    <div style="display: flex; gap: 10px; margin-bottom: 8px;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.85em;">흑백 기본매수(장)</label>
                            <input type="number" id="contract-base-bw" placeholder="1000" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.85em;">컬러 기본매수(장)</label>
                            <input type="number" id="contract-base-color" placeholder="100" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                        </div>
                    </div>

                    <div style="display: flex; gap: 10px;">
                        <div style="flex: 1;">
                            <label style="font-size: 0.85em;">흑백 초과(원)</label>
                            <input type="number" id="contract-rate-bw" value="10" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.85em;">컬러(A4) 초과(원)</label>
                            <input type="number" id="contract-rate-a4" value="100" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                        </div>
                        <div style="flex: 1;">
                            <label style="font-size: 0.85em;">컬러(A3) 초과(원)</label>
                            <input type="number" id="contract-rate-a3" value="200" style="width: 100%; padding: 5px; border: 1px solid #ccc;">
                        </div>
                    </div>
                </div>
                <div id="panel-stock" style="display:flex; gap:5px;">
                    <select id="sel-stock-asset" style="flex:1; padding:8px;">
                        <option value="">-- 창고(재고) 기기 선택 --</option>
                    </select>
                    <button id="btn-add-stock" class="btn-secondary">추가(배정)</button>
                </div>

                <div id="panel-new" class="hidden" style="display:flex; gap:5px;">
                    <select id="sel-new-model-id" style="flex:1; padding:8px;">
                        <option value="">모델 선택 (예: D410)</option>
                    </select>
                    <input type="text" id="inp-new-serial" placeholder="S/N 입력" style="width:150px; padding:8px;">
                    <button id="btn-create-asset" class="btn-secondary">등록 및 배정</button>
                </div>
            </div>
        </div>
        
        <div id="msg-save-first" class="form-group-box" style="text-align:center; color:#888; padding:30px;">
            ℹ️ 거래처 정보를 먼저 [저장]하시면 기기를 등록할 수 있습니다.
        </div>
    </div>
    
    <ul id="client-list-ul" class="client-list">
        <li>데이터 로딩 중...</li>
    </ul>
</section>