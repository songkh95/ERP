<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ë³µí•©ê¸° ë Œíƒˆ ê²¬ì  ì›ê°€ê³„ì‚°</title>
    <!-- html2pdf.js: PDF ìƒì„±ìš© ë¼ì´ë¸ŒëŸ¬ë¦¬ (html2canvas + jsPDF í†µí•©) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        body {
            font-family: 'Malgun Gothic', 'Apple SD Gothic Neo', sans-serif;
            background-color: #f5f5f5;
            margin: 0;
            padding: 10px; /* ëª¨ë°”ì¼ì—ì„œ ì—¬ë°± ì¤„ì„ */
            color: #333;
        }
        .container {
            max-width: 100%; /* ëª¨ë°”ì¼ì—ì„œ ê½‰ ì°¨ê²Œ */
            margin: 0 auto;
            background-color: white;
            padding: 15px; /* ë‚´ë¶€ íŒ¨ë”© ì¤„ì„ */
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            border-radius: 8px;
            overflow-x: hidden; /* ì»¨í…Œì´ë„ˆ ìì²´ ìŠ¤í¬ë¡¤ ë°©ì§€ */
            position: relative;
        }
        h1 {
            text-align: center;
            font-size: 20px; /* ì œëª© í¬ê¸° ì¡°ì • */
            margin-bottom: 5px;
            color: #2c3e50;
        }

        h2 {
            font-size: 16px;
            border-left: 5px solid #3498db;
            padding-left: 8px;
            margin-top: 25px;
            margin-bottom: 10px;
            color: #2980b9;
            display: flex;
            align-items: center;
        }
        /* ì •ë³´ ì•„ì´ì½˜ ìŠ¤íƒ€ì¼ */
        .info-icon {
            display: inline-flex;
            justify-content: center;
            align-items: center;
            width: 18px;
            height: 18px;
            margin-left: 6px;
            background-color: #3498db;
            color: white;
            border-radius: 50%;
            font-size: 11px;
            font-weight: bold;
            font-style: italic;
            cursor: pointer;
            box-shadow: 1px 1px 3px rgba(0,0,0,0.2);
        }
        .info-icon:hover {
            background-color: #2980b9;
        }
        
        /* í…Œì´ë¸” ë˜í¼: ê°€ë¡œ ìŠ¤í¬ë¡¤ ê°€ëŠ¥í•˜ê²Œ */
        .table-responsive {
            width: 100%;
            overflow-x: auto;
            -webkit-overflow-scrolling: touch; /* ë¶€ë“œëŸ¬ìš´ ìŠ¤í¬ë¡¤ */
            margin-bottom: 15px;
        }

        table {
            width: 100%;
            min-width: 600px; /* í…Œì´ë¸” ìµœì†Œ ë„ˆë¹„ ì„¤ì • (ê¹¨ì§ ë°©ì§€) */
            border-collapse: collapse;
            font-size: 12px; /* í°íŠ¸ í¬ê¸° ì¡°ì • */
        }
        th, td {
            border: 1px solid #ddd;
            padding: 6px 4px; /* ì…€ íŒ¨ë”© ì¤„ì„ */
            text-align: center;
        }
        th {
            background-color: #eee;
            font-weight: bold;
            color: #555;
            white-space: nowrap; /* ì œëª© ì¤„ë°”ê¿ˆ ë°©ì§€ */
        }
        input[type="text"] {
            width: 95%; /* ì…ë ¥ì°½ ë„ˆë¹„ ìµœëŒ€ë¡œ */
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-align: right;
            font-family: inherit;
            font-size: 12px;
        }
        input[type="number"] {
            width: 70%;
            padding: 4px;
            border: 1px solid #ccc;
            border-radius: 3px;
            text-align: center;
            font-family: inherit;
            font-weight: bold;
            color: #2980b9;
            font-size: 12px;
        }
        input:focus {
            border-color: #3498db;
            outline: none;
        }
        .readonly {
            background-color: #f9f9f9;
            color: #555;
            border: 1px solid #eee;
            font-weight: bold;
            pointer-events: none;
        }
        .section-header {
            background-color: #444;
            color: white;
        }
        .sub-header {
            background-color: #f0f0f0;
        }
        .result-row {
            background-color: #e8f6f3;
            font-weight: bold;
        }
        .highlight-row {
            background-color: #fffde7;
        }
        .profit-positive {
            color: blue;
        }
        .profit-negative {
            color: red;
        }
        .info-text {
            font-size: 11px;
            color: #888;
            margin-top: 5px;
            text-align: right;
            margin-bottom: 5px;
        }

        /* ì €ì¥ ë²„íŠ¼ ìŠ¤íƒ€ì¼ (PDF) */
        .save-btn-container {
            text-align: center;
            margin-top: 30px;
            margin-bottom: 20px;
        }
        .save-btn {
            background-color: #e74c3c; /* PDF ìƒ‰ìƒ(ë¶‰ì€ìƒ‰) */
            color: white;
            border: none;
            padding: 12px 25px;
            border-radius: 5px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: background-color 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        .save-btn:active {
            transform: translateY(2px);
            box-shadow: 0 1px 2px rgba(0,0,0,0.1);
        }
        .save-btn:hover {
            background-color: #c0392b;
        }
        .save-btn span {
            margin-left: 8px;
        }

        /* ëª¨ë‹¬ íŒì—… ìŠ¤íƒ€ì¼ */
        .modal {
            display: none; 
            position: fixed; 
            z-index: 1000; 
            left: 0;
            top: 0;
            width: 100%; 
            height: 100%; 
            overflow: auto; 
            background-color: rgba(0,0,0,0.5); 
        }
        .modal-content {
            background-color: #fefefe;
            margin: 10% auto; /* ìƒë‹¨ ì—¬ë°± ì¤„ì„ */
            padding: 20px;
            border: 1px solid #888;
            width: 85%; /* ëª¨ë‹¬ ë„ˆë¹„ ì¡°ì • */
            max-width: 500px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
            position: relative;
        }
        .close-btn {
            color: #aaa;
            float: right;
            font-size: 24px;
            font-weight: bold;
            cursor: pointer;
            position: absolute;
            right: 15px;
            top: 10px;
        }
        .modal-title {
            font-size: 18px;
            font-weight: bold;
            color: #2c3e50;
            margin-bottom: 10px;
            padding-bottom: 8px;
            border-bottom: 2px solid #3498db;
        }
        .modal-body {
            font-size: 13px;
            line-height: 1.5;
            color: #444;
        }

        /* ë¯¸ë””ì–´ ì¿¼ë¦¬: ëª¨ë°”ì¼ ê°€ë¡œ ëª¨ë“œ ë° ì‘ì€ í™”ë©´ ìµœì í™” */
        @media screen and (max-width: 768px) {
            .container {
                padding: 10px;
            }
            h1 { font-size: 18px; }
            h2 { font-size: 15px; margin-top: 20px; }
            table { font-size: 11px; }
            th, td { padding: 4px 2px; }
            input[type="text"], input[type="number"] { font-size: 11px; padding: 3px; }
        }
    </style>
</head>
<body>

<div class="container" id="calculator-content">
    <h1>ë³µí•©ê¸° ë Œíƒˆ ì›ê°€ ê³„ì‚°ì„œ</h1>

    <!-- 1. ì„ëŒ€ì¡°ê±´ ë° ì˜ˆìƒ ì¶œë ¥ëŸ‰ -->
    <h2>1. ì„ëŒ€ì¡°ê±´ ë° ì˜ˆìƒ ì¶œë ¥ëŸ‰ <span class="info-icon" onclick="openModal(1)" data-html2canvas-ignore="true">i</span></h2>
    <div class="table-responsive">
        <table>
            <colgroup>
                <col style="width: 20%">
                <col style="width: 20%">
                <col style="width: 15%">
                <col style="width: 20%">
                <col style="width: 25%">
            </colgroup>
            <tr>
                <th>ê¸°ì¢…ëª…</th>
                <th>ê¸°ê³„ì›ê°€</th>
                <th>ì„ëŒ€ê¸°ê°„ (ê°œì›”)</th>
                <th>ê¸°ê³„ ê°ê°€ìƒê° (ì›”)</th>
                <th>ì—° ê¸ˆë¦¬ (%)</th>
            </tr>
            <tr>
                <td><input type="text" id="modelName" value="D3375CFPS"></td>
                <td><input type="text" inputmode="numeric" id="machineCost" value="2850000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="term" value="36" oninput="handleInput(this)"></td>
                <td><input type="text" id="monthlyDepreciation" class="readonly" readonly></td>
                <td><input type="text" inputmode="decimal" id="interestRate" value="0" oninput="handleInput(this)"></td>
            </tr>
        </table>
    </div>

    <div class="table-responsive">
        <table>
             <colgroup>
                <col style="width: 15%">
                <col style="width: 15%">
                <col style="width: 20%">
                <col style="width: 25%">
                <col style="width: 25%">
            </colgroup>
            <!-- ê¸°ë³¸ ì„ëŒ€ ì¡°ê±´ -->
            <tr>
                <th rowspan="2" class="section-header">ì„ëŒ€ê³„ì•½</th>
                <th class="sub-header">êµ¬ë¶„</th>
                <th class="sub-header">ê¸°ë³¸ìš”ê¸ˆ (ì›”)</th>
                <th class="sub-header">ì˜ˆìƒ ì¶œë ¥ëŸ‰ (ì›”)</th>
                <th class="sub-header">ì´ ì¶œë ¥ëŸ‰ (ê³„ì•½ê¸°ê°„)</th>
            </tr>
            <tr>
                <td>ê¸ˆì•¡ ì„¤ì •</td>
                <td><input type="text" inputmode="numeric" id="rentalFee" value="100000" oninput="handleInput(this)"></td>
                <td>í‘ë°±: <input type="text" inputmode="numeric" id="monthlyBW" value="1000" style="width: 50px;" oninput="handleInput(this)"></td>
                <td><input type="text" id="totalBW" class="readonly" readonly></td>
            </tr>
            <tr>
                <th rowspan="2" class="section-header">ê¸°ë³¸ì œê³µ</th>
                <td>í‘ë°±ë§¤ìˆ˜</td>
                <td><input type="text" inputmode="numeric" id="basicBW" value="1000" oninput="handleInput(this)"></td>
                <td>ì¹¼ë¼: <input type="text" inputmode="numeric" id="monthlyColor" value="100" style="width: 50px;" oninput="handleInput(this)"></td>
                <td><input type="text" id="totalColor" class="readonly" readonly></td>
            </tr>
            <tr>
                <td>ì¹¼ë¼ë§¤ìˆ˜</td>
                <td><input type="text" inputmode="numeric" id="basicColor" value="100" oninput="handleInput(this)"></td>
                <td rowspan="2" style="vertical-align: middle; background-color: #fafafa; font-weight:bold;">ì´ í•©ê³„ (í‘+ì¹¼)</td>
                <td rowspan="2" style="vertical-align: middle;">
                    <input type="text" id="totalOutputAll" class="readonly" style="font-weight:bold;" readonly>
                </td>
            </tr>
            
            <!-- ì¶”ê°€ìš”ê¸ˆ ë° ì„ëŒ€ìš”ê¸ˆ ì´ì•¡ ì„¹ì…˜ -->
            <tr>
                <th rowspan="3" class="section-header">ì¶”ê°€ìš”ê¸ˆ<br>(ì¥ë‹¹)</th>
                <td>í‘ë°±</td>
                <td><input type="text" inputmode="numeric" id="addFeeBW" value="10" oninput="handleInput(this)"></td>
            </tr>
            <tr class="highlight-row">
                <td>ì¹¼ë¼ (A4)</td>
                <td><input type="text" inputmode="numeric" id="addFeeColorA4" value="100" oninput="handleInput(this)"></td>
                <td style="font-weight:bold; color:#2980b9;">ì„ëŒ€ìš”ê¸ˆ (ë§¤ì›”)</td>
                <td><input type="text" id="displayMonthlyFee" class="readonly" style="font-weight:bold; color:#2980b9;" readonly></td>
            </tr>
            <tr class="highlight-row">
                <td>ì¹¼ë¼ (A3)</td>
                <td><input type="text" inputmode="numeric" id="addFeeColorA3" value="200" oninput="handleInput(this)"></td>
                <td style="font-weight:bold; color:#2c3e50;">ì„ëŒ€ìš”ê¸ˆ (ì´ì•¡)</td>
                <td><input type="text" id="displayTotalFee" class="readonly" style="font-weight:bold; color:#2c3e50;" readonly></td>
            </tr>
        </table>
    </div>

    <!-- 2. ì†Œìš”ë¹„ìš© -->
    <h2>2. ì†Œìš”ë¹„ìš© (ì†Œëª¨í’ˆ) <span class="info-icon" onclick="openModal(2)" data-html2canvas-ignore="true">i</span></h2>
    <div class="info-text">* ê°œìˆ˜(x)ë¥¼ ì¡°ì •í•˜ë©´ ë‹¨ê°€(ì„¸íŠ¸ ê°€ê²©)ê°€ ìë™ìœ¼ë¡œ ë³€ê²½ë©ë‹ˆë‹¤. (ì˜ˆ: 151,000ì› x 4ê°œ = 604,000ì›)</div>
    <div class="table-responsive">
        <table>
            <colgroup>
                <col style="width: 12%">
                <col style="width: 18%">
                <col style="width: 12%">
                <col style="width: 15%">
                <col style="width: 10%">
                <col style="width: 13%">
                <col style="width: 20%">
            </colgroup>
            <tr>
                <th>êµ¬ë¶„</th>
                <th>ì†Œëª¨í’ˆëª…</th>
                <th>ìˆ˜ëª… (Life)</th>
                <th>ë‹¨ê°€</th>
                <th>ê°œìˆ˜(x)</th>
                <th>êµí™˜íšŸìˆ˜</th>
                <th>ì†Œìš”ê¸ˆì•¡ (ì´)</th>
            </tr>
            <!-- Row 1: Drum Common (Merged) -->
            <tr>
                <td rowspan="5" style="vertical-align: middle;">ì†Œëª¨í’ˆ</td>
                <td>ë“œëŸ¼ (K/C/M/Y)</td>
                <td><input type="text" inputmode="numeric" id="life_drumCommon" value="143000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="cost_drumCommon" value="151000" oninput="handleInput(this)"></td>
                <td><input type="number" id="qty_drumCommon" value="4" min="1" oninput="handleInput(this)"></td>
                <td><input type="text" id="count_drumCommon" class="readonly" readonly></td>
                <td><input type="text" id="total_drumCommon" class="readonly" readonly></td>
            </tr>
            <!-- Row 3: Toner B -->
            <tr>
                <td>í† ë„ˆ B</td>
                <td><input type="text" inputmode="numeric" id="life_tonerB" value="26000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="cost_tonerB" value="82000" oninput="handleInput(this)"></td>
                <td><input type="number" id="qty_tonerB" value="1" min="1" oninput="handleInput(this)"></td>
                <td><input type="text" id="count_tonerB" class="readonly" readonly></td>
                <td><input type="text" id="total_tonerB" class="readonly" readonly></td>
            </tr>
            <!-- Row 4: Toner C/M/Y -->
            <tr>
                <td>í† ë„ˆ C/M/Y</td>
                <td><input type="text" inputmode="numeric" id="life_tonerColor" value="15000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="cost_tonerColor" value="133000" oninput="handleInput(this)"></td>
                <td><input type="number" id="qty_tonerColor" value="3" min="1" oninput="handleInput(this)"></td>
                <td><input type="text" id="count_tonerColor" class="readonly" readonly></td>
                <td><input type="text" id="total_tonerColor" class="readonly" readonly></td>
            </tr>
            <!-- Row 5: Waste Toner -->
            <tr>
                <td>íí† ë„ˆí†µ</td>
                <td><input type="text" inputmode="numeric" id="life_waste" value="46000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="cost_waste" value="38000" oninput="handleInput(this)"></td>
                <td><input type="number" id="qty_waste" value="1" min="1" oninput="handleInput(this)"></td>
                <td><input type="text" id="count_waste" class="readonly" readonly></td>
                <td><input type="text" id="total_waste" class="readonly" readonly></td>
            </tr>
            <!-- Row 6: Fuser -->
            <tr>
                <td>Fuser</td>
                <td><input type="text" inputmode="numeric" id="life_fuser" value="100000" oninput="handleInput(this)"></td>
                <td><input type="text" inputmode="numeric" id="cost_fuser" value="250000" oninput="handleInput(this)"></td>
                <td><input type="number" id="qty_fuser" value="1" min="1" oninput="handleInput(this)"></td>
                <td><input type="text" id="count_fuser" class="readonly" readonly></td>
                <td><input type="text" id="total_fuser" class="readonly" readonly></td>
            </tr>
            <tr class="result-row">
                <td colspan="6">ì†Œëª¨í’ˆ ì´ ì†Œìš”ê¸ˆì•¡ í•©ê³„</td>
                <td><input type="text" id="grandTotalConsumables" class="readonly" style="text-align: center; font-size: 1.1em;" readonly></td>
            </tr>
        </table>
    </div>

    <!-- 3. ì„ëŒ€ì‹œ ì´ìµ -->
    <h2>3. ì„ëŒ€ì‹œ ì´ìµ (ì›”) <span class="info-icon" onclick="openModal(3)" data-html2canvas-ignore="true">i</span></h2>
    <div class="table-responsive">
        <table>
            <colgroup>
                <col style="width: 10%">
                <col style="width: 12%">
                <col style="width: 12%">
                <col style="width: 12%">
                <col style="width: 12%">
                <col style="width: 12%">
                <col style="width: 12%">
                <col style="width: 10%">
                <col style="width: 12%">
            </colgroup>
            <tr>
                <th>êµ¬ë¶„</th>
                <th>ê¸°ê³„ ê°ê°€ (ì›”)</th>
                <th>ê¸ˆë¦¬ë¹„ìš© (ì›”)</th>
                <th>ì†Œëª¨í’ˆ ë¹„ìš© (ì›”)</th>
                <th>ì›ê°€ í•©ê³„ (ì›”)</th>
                <th>ì„ëŒ€ ìš”ê¸ˆ (ì›”)</th>
                <th>ì´ìµ (ì›”)</th>
                <th>ë§ˆì§„ìœ¨ (%)</th>
                <th>ì´ ì´ìµ (ì „ì²´)</th>
            </tr>
            <tr>
                <td>ê¸ˆì•¡</td>
                <td><input type="text" id="profit_machine" class="readonly" readonly></td>
                <td><input type="text" id="profit_interest" class="readonly" readonly></td>
                <td><input type="text" id="profit_consumable" class="readonly" readonly></td>
                <td><input type="text" id="profit_cost_total" class="readonly" style="color: #d35400;" readonly></td>
                <td><input type="text" id="profit_rental_fee" class="readonly" readonly></td>
                <td><input type="text" id="profit_monthly" class="readonly" style="font-weight:bold;" readonly></td>
                <td><input type="text" id="profit_margin_rate" class="readonly" style="font-weight:bold; text-align:center;" readonly></td>
                <td><input type="text" id="profit_total" class="readonly" style="font-weight:bold;" readonly></td>
            </tr>
        </table>
    </div>

    <!-- 4. ì›ê°€ íšŒìˆ˜ ë‚´ì—­ -->
    <h2>4. ì›ê°€ íšŒìˆ˜ ë‚´ì—­ (BEP) <span class="info-icon" onclick="openModal(4)" data-html2canvas-ignore="true">i</span></h2>
    <div class="table-responsive">
        <table>
            <tr>
                <th>êµ¬ë¶„</th>
                <th>ê¸°ê³„ë¹„ìš©ë§Œ íšŒìˆ˜ (ê°œì›”)</th>
                <th>ê¸°ê³„ + ì†Œëª¨í’ˆ ë¹„ìš© íšŒìˆ˜ (ê°œì›”)</th>
            </tr>
            <tr>
                <td>ì†ìµë¶„ê¸°ì </td>
                <td><input type="text" id="bep_machine" class="readonly" style="text-align: center;" readonly></td>
                <td><input type="text" id="bep_total" class="readonly" style="text-align: center; background-color: #fff9c4;" readonly></td>
            </tr>
        </table>
    </div>

    <!-- 5. ë¶„ì„ ë° ì°¸ê³  ì§€í‘œ -->
    <h2>5. ë¶„ì„ ë° ì°¸ê³  ì§€í‘œ <span class="info-icon" onclick="openModal(5)" data-html2canvas-ignore="true">i</span></h2>
    <div class="table-responsive">
        <table>
            <colgroup>
                <col style="width: 25%">
                <col style="width: 25%">
                <col style="width: 25%">
                <col style="width: 25%">
            </colgroup>
            <tr>
                <th>ì¥ë‹¹ í‰ê·  ì›ê°€ (ì›)</th>
                <th>ë§¤ì¶œ ëŒ€ë¹„ ì›ê°€ìœ¨ (%)</th>
                <th>ì†ìµë¶„ê¸° ëˆ„ì  ì¶œë ¥ëŸ‰ (ë§¤)</th>
                <th style="background-color: #ffe0b2;">ì›” ì†ìµë¶„ê¸° í•œê³„ ì¶œë ¥ëŸ‰ (Limit)</th>
            </tr>
            <tr>
                <td><input type="text" id="analysis_cpp" class="readonly" style="text-align: center; font-weight:bold; color:#d35400;" readonly></td>
                <td><input type="text" id="analysis_cost_ratio" class="readonly" style="text-align: center;" readonly></td>
                <td><input type="text" id="analysis_bep_volume" class="readonly" style="text-align: center; color:#2980b9;" readonly></td>
                <td><input type="text" id="analysis_monthly_bep_volume" class="readonly" style="text-align: center; font-weight:bold; background-color: #fff3e0; color:#d35400;" readonly></td>
            </tr>
        </table>
    </div>

    <!-- PDF ì €ì¥ ë²„íŠ¼ (ì €ì¥ ì‹œ ë¬¸ì„œì—ëŠ” í¬í•¨ë˜ì§€ ì•ŠìŒ) -->
    <div class="save-btn-container" data-html2canvas-ignore="true">
        <button class="save-btn" onclick="saveAsPDF()">
            ğŸ“„ ê²¬ì ì„œ PDFë¡œ ì €ì¥
        </button>
    </div>

</div>

<!-- ì„¤ëª… ëª¨ë‹¬ (Modal) -->
<div id="infoModal" class="modal">
    <div class="modal-content">
        <span class="close-btn" onclick="closeModal()">&times;</span>
        <div id="modalHeader" class="modal-title"></div>
        <div id="modalBody" class="modal-body"></div>
    </div>
</div>

<script>
    // PDF ì €ì¥ í•¨ìˆ˜
    function saveAsPDF() {
        const element = document.getElementById('calculator-content');
        const modelName = document.getElementById('modelName').value || 'ê²¬ì ì„œ';
        
        const date = new Date();
        const dateStr = date.getFullYear() + 
                      String(date.getMonth() + 1).padStart(2, '0') + 
                      String(date.getDate()).padStart(2, '0');
        
        const fileName = `ê²¬ì ì„œ_${modelName}_${dateStr}.pdf`;

        // 1. ì €ì¥ ì „ ì²˜ë¦¬: inputì„ í…ìŠ¤íŠ¸ë¡œ ë³€í™˜ (ì˜ë¦¼ ë°©ì§€)
        const inputs = element.querySelectorAll('input');
        const originalValues = [];
        
        inputs.forEach((input, index) => {
            originalValues[index] = input.value;
            // span íƒœê·¸ë¡œ êµì²´
            const span = document.createElement('span');
            span.textContent = input.value;
            span.style.display = 'inline-block';
            span.style.width = input.style.width || '100%';
            span.style.textAlign = input.style.textAlign || 'left';
            span.style.fontWeight = input.style.fontWeight || 'normal';
            span.style.color = input.style.color || 'inherit';
            span.style.fontSize = input.style.fontSize || 'inherit';
            span.className = 'pdf-text-replace'; // ë‚˜ì¤‘ì— ì‹ë³„ìš©
            
            input.style.display = 'none';
            input.parentNode.insertBefore(span, input);
        });

        // 2. html2pdf ì„¤ì • ë° ì‹¤í–‰
        const opt = {
            margin:       10, // ì—¬ë°± (mm)
            filename:     fileName,
            image:        { type: 'jpeg', quality: 0.98 },
            html2canvas:  { scale: 2, useCORS: true, scrollY: 0 },
            jsPDF:        { unit: 'mm', format: 'a4', orientation: 'portrait' },
            pagebreak:    { mode: ['avoid-all', 'css', 'legacy'] } // í˜ì´ì§€ ë¶„í•  ì„¤ì •
        };

        html2pdf().set(opt).from(element).save().then(() => {
            // 3. ì €ì¥ í›„ ë³µêµ¬: í…ìŠ¤íŠ¸ë¥¼ ë‹¤ì‹œ inputìœ¼ë¡œ
            const replacements = element.querySelectorAll('.pdf-text-replace');
            replacements.forEach(span => span.remove());
            
            inputs.forEach(input => {
                input.style.display = '';
            });
        }).catch(err => {
            alert("PDF ì €ì¥ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: " + err);
            // ì—ëŸ¬ ë°œìƒ ì‹œì—ë„ ë³µêµ¬
            const replacements = element.querySelectorAll('.pdf-text-replace');
            replacements.forEach(span => span.remove());
            inputs.forEach(input => {
                input.style.display = '';
            });
        });
    }

    function formatNumber(num) {
        if (num === undefined || num === null || isNaN(num)) return "0";
        return num.toLocaleString('ko-KR', { maximumFractionDigits: 0 });
    }

    function formatDecimal(num, digits) {
        if (isNaN(num)) return "0";
        return num.toLocaleString('ko-KR', { minimumFractionDigits: digits, maximumFractionDigits: digits });
    }

    function getVal(id) {
        const el = document.getElementById(id);
        if (!el) return 0;
        return parseFloat(el.value.replace(/,/g, '')) || 0;
    }
    
    function getQty(id) {
        const el = document.getElementById(id);
        if (!el) return 1;
        let val = parseFloat(el.value);
        return (val > 0) ? val : 1;
    }

    function setVal(id, val, isMoney = true) {
        const el = document.getElementById(id);
        if (!el) return;
        if (isMoney) {
            el.value = formatNumber(val);
        } else {
            el.value = val; 
        }
    }

    function handleInput(el) {
        // ê°œìˆ˜ ë³€ê²½ ì‹œ ë‹¨ê°€(ì„¸íŠ¸ê°€ê²©) ìë™ ì—…ë°ì´íŠ¸
        if (el.id.startsWith('qty_')) {
            const costId = el.id.replace('qty_', 'cost_');
            const costEl = document.getElementById(costId);
            if (costEl) {
                const qty = getQty(el.id);
                const baseCost = parseFloat(costEl.dataset.baseCost) || 0;
                const newSetPrice = baseCost * qty;
                setVal(costId, newSetPrice);
            }
        } 
        // ë‹¨ê°€(ì„¸íŠ¸ê°€ê²©) ì§ì ‘ ì…ë ¥ ì‹œ 1ê°œë‹¹ ë‹¨ê°€ ì¬ê³„ì‚°
        else if (el.id.startsWith('cost_')) {
            const qtyId = el.id.replace('cost_', 'qty_');
            const qtyEl = document.getElementById(qtyId);
            if (qtyEl) { 
                const qty = getQty(qtyId);
                const currentSetPrice = getVal(el.id);
                if (qty > 0) {
                    el.dataset.baseCost = currentSetPrice / qty;
                }
            }
        }
        
        formatInput(el);
        calculate();
    }

    function formatInput(el) {
        let val = el.value.replace(/[^0-9.]/g, ''); 
        if (!val) {
            el.value = '';
            return;
        }

        let parts = val.split('.');
        let intPart = parts[0];
        
        intPart = intPart.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
        let res = intPart + (parts.length > 1 ? '.' + parts[1] : '');
        
        if (el.value !== res) {
            el.value = res;
        }
    }

    function calculate() {
        const machineCost = getVal('machineCost');
        const term = getVal('term');
        const interestRate = getVal('interestRate');
        const rentalFee = getVal('rentalFee');
        const monthlyBW = getVal('monthlyBW');
        const monthlyColor = getVal('monthlyColor');

        // 1. ì„ëŒ€ì¡°ê±´ ê³„ì‚°
        const monthlyDepreciation = term > 0 ? machineCost / term : 0;
        setVal('monthlyDepreciation', monthlyDepreciation);

        const totalBW = monthlyBW * term;
        const totalColor = monthlyColor * term;
        const totalOutputAll = totalBW + totalColor;

        setVal('totalBW', totalBW);
        setVal('totalColor', totalColor);
        setVal('totalOutputAll', totalOutputAll);

        setVal('displayMonthlyFee', rentalFee);
        const totalRentalFee = rentalFee * term;
        setVal('displayTotalFee', totalRentalFee);


        // 2. ì†Œëª¨í’ˆ ê³„ì‚°
        function calcConsumableWithQty(lifeId, costId, qtyId, countId, totalId, totalSingleUnitsNeeded) {
            const life = getVal(lifeId);
            const setPrice = getVal(costId); 
            const qty = getQty(qtyId);
            
            let exchangeCountSet = 0;
            if (life > 0) {
                exchangeCountSet = totalSingleUnitsNeeded / qty;
            }
            
            const totalCost = setPrice * exchangeCountSet;

            document.getElementById(countId).value = formatDecimal(exchangeCountSet, 2);
            setVal(totalId, totalCost);
            
            return totalCost;
        }
        
        function calcNormal(lifeId, costId, qtyId, countId, totalId, basisOutput) {
            const life = getVal(lifeId);
            let totalUnits = 0;
            if(life > 0) totalUnits = basisOutput / life;
            return calcConsumableWithQty(lifeId, costId, qtyId, countId, totalId, totalUnits);
        }

        let sumConsumables = 0;

        // ë“œëŸ¼ (K/C/M/Y)
        const lifeDrum = getVal('life_drumCommon');
        let totalDrumUnits = 0;
        if (lifeDrum > 0) {
            totalDrumUnits = (totalOutputAll + (totalColor * 3)) / lifeDrum;
        }
        sumConsumables += calcConsumableWithQty('life_drumCommon', 'cost_drumCommon', 'qty_drumCommon', 'count_drumCommon', 'total_drumCommon', totalDrumUnits);

        // í† ë„ˆ B
        sumConsumables += calcNormal('life_tonerB', 'cost_tonerB', 'qty_tonerB', 'count_tonerB', 'total_tonerB', totalOutputAll);

        // í† ë„ˆ C/M/Y
        const lifeTonerColor = getVal('life_tonerColor');
        let totalTonerColorUnits = 0;
        if(lifeTonerColor > 0) {
            totalTonerColorUnits = (totalColor / lifeTonerColor) * 3;
        }
        sumConsumables += calcConsumableWithQty('life_tonerColor', 'cost_tonerColor', 'qty_tonerColor', 'count_tonerColor', 'total_tonerColor', totalTonerColorUnits);

        // íí† ë„ˆí†µ, Fuser
        sumConsumables += calcNormal('life_waste', 'cost_waste', 'qty_waste', 'count_waste', 'total_waste', totalOutputAll);
        sumConsumables += calcNormal('life_fuser', 'cost_fuser', 'qty_fuser', 'count_fuser', 'total_fuser', totalOutputAll);

        setVal('grandTotalConsumables', sumConsumables);


        // 3. ì´ìµ ë¶„ì„
        const monthlyInterest = (machineCost * (interestRate / 100)) / 12;
        const monthlyConsumableCost = term > 0 ? sumConsumables / term : 0;
        const totalMonthlyCost = monthlyDepreciation + monthlyInterest + monthlyConsumableCost;
        const monthlyProfit = rentalFee - totalMonthlyCost;
        const totalProfit = monthlyProfit * term;
        const marginRate = rentalFee > 0 ? (monthlyProfit / rentalFee) * 100 : 0;

        setVal('profit_machine', monthlyDepreciation);
        setVal('profit_interest', monthlyInterest);
        setVal('profit_consumable', monthlyConsumableCost);
        setVal('profit_cost_total', totalMonthlyCost);
        setVal('profit_rental_fee', rentalFee);
        setVal('profit_monthly', monthlyProfit);
        setVal('profit_total', totalProfit);
        
        document.getElementById('profit_margin_rate').value = formatDecimal(marginRate, 1) + " %";
        const marginEl = document.getElementById('profit_margin_rate');
        marginEl.style.color = marginRate >= 0 ? "blue" : "red";

        const profitEl = document.getElementById('profit_monthly');
        profitEl.style.color = monthlyProfit >= 0 ? "blue" : "red";

        // 4. BEP
        const bepMachine = rentalFee > 0 ? machineCost / rentalFee : 0;
        const bepTotal = rentalFee > 0 ? (machineCost + sumConsumables) / rentalFee : 0;

        document.getElementById('bep_machine').value = formatDecimal(bepMachine, 1) + " ê°œì›”";
        document.getElementById('bep_total').value = formatDecimal(bepTotal, 1) + " ê°œì›”";

        // 5. ë¶„ì„ ë° ì°¸ê³  ì§€í‘œ (ì¶”ê°€ë¨)
        const monthlyTotalOutput = monthlyBW + monthlyColor;
        const avgCostPerPage = monthlyTotalOutput > 0 ? totalMonthlyCost / monthlyTotalOutput : 0;
        const costRatio = rentalFee > 0 ? (totalMonthlyCost / rentalFee) * 100 : 0;
        const bepVolume = bepTotal * monthlyTotalOutput;

        document.getElementById('analysis_cpp').value = formatNumber(Math.round(avgCostPerPage)) + " ì›";
        document.getElementById('analysis_cost_ratio').value = formatDecimal(costRatio, 1) + " %";
        document.getElementById('analysis_bep_volume').value = formatNumber(Math.round(bepVolume)) + " ë§¤";

        // [New] Monthly BEP Volume Limit Calculation
        // Logic: RentalFee - FixedCost = Max Variable Cost
        // Max Variable Cost >= (CPP_BW * VolBW) + (CPP_Color * VolColor)
        // Assume ratio is fixed based on input
        const fixedMonthlyCost = monthlyDepreciation + monthlyInterest;
        const maxVariableCost = rentalFee - fixedMonthlyCost;
        
        // 1. Drum CPP
        const drumSetPrice = getVal('cost_drumCommon');
        const drumQty = getQty('qty_drumCommon');
        const drumLife = getVal('life_drumCommon');
        const drumUnitPrice = drumQty > 0 ? drumSetPrice / drumQty : 0;
        const cppDrumBW = drumLife > 0 ? drumUnitPrice / drumLife : 0;
        const cppDrumColorTotal = drumLife > 0 ? (drumUnitPrice * 4) / drumLife : 0;

        // 2. Toner B CPP
        const tonerBSetPrice = getVal('cost_tonerB');
        const tonerBQty = getQty('qty_tonerB');
        const tonerBLife = getVal('life_tonerB');
        const tonerBUnitPrice = tonerBQty > 0 ? tonerBSetPrice / tonerBQty : 0;
        const cppTonerB = tonerBLife > 0 ? tonerBUnitPrice / tonerBLife : 0;

        // 3. Toner C/M/Y CPP
        const tonerColorSetPrice = getVal('cost_tonerColor');
        const tonerColorQty = getQty('qty_tonerColor'); 
        const tonerColorLife = getVal('life_tonerColor');
        const tonerColorUnitPrice = tonerColorQty > 0 ? tonerColorSetPrice / tonerColorQty : 0;
        const cppTonerColor = tonerColorLife > 0 ? (tonerColorUnitPrice * 3) / tonerColorLife : 0;

        // 4. Waste CPP
        const wasteSetPrice = getVal('cost_waste');
        const wasteQty = getQty('qty_waste');
        const wasteLife = getVal('life_waste');
        const wasteUnitPrice = wasteQty > 0 ? wasteSetPrice / wasteQty : 0;
        const cppWaste = wasteLife > 0 ? wasteUnitPrice / wasteLife : 0;

        // 5. Fuser CPP
        const fuserSetPrice = getVal('cost_fuser');
        const fuserQty = getQty('qty_fuser');
        const fuserLife = getVal('life_fuser');
        const fuserUnitPrice = fuserQty > 0 ? fuserSetPrice / fuserQty : 0;
        const cppFuser = fuserLife > 0 ? fuserUnitPrice / fuserLife : 0;

        const cppFullBW = cppDrumBW + cppTonerB + cppWaste + cppFuser;
        const cppFullColor = cppDrumColorTotal + cppTonerB + cppTonerColor + cppWaste + cppFuser; 
        
        let monthlyBepDisplay = "";
        
        if (maxVariableCost < 0) {
            monthlyBepDisplay = "ì ì (ê³ ì •ë¹„ ì´ˆê³¼)";
        } else {
            if (monthlyTotalOutput > 0) {
                const ratioBW = monthlyBW / monthlyTotalOutput;
                const ratioColor = monthlyColor / monthlyTotalOutput;
                const weightedAvgCPP = (cppFullBW * ratioBW) + (cppFullColor * ratioColor);
                
                if (weightedAvgCPP > 0) {
                    const maxVol = maxVariableCost / weightedAvgCPP;
                    const maxVolBW = maxVol * ratioBW;
                    const maxVolColor = maxVol * ratioColor;
                    monthlyBepDisplay = `ì´ ${formatNumber(Math.round(maxVol))}ë§¤ (í‘:${formatNumber(Math.round(maxVolBW))} / ì¹¼:${formatNumber(Math.round(maxVolColor))})`;
                } else {
                    monthlyBepDisplay = "ë¬´ì œí•œ (ì›ê°€ 0ì›)";
                }
            } else {
                monthlyBepDisplay = "ì¶œë ¥ ë¹„ìœ¨ ì…ë ¥ í•„ìš”";
            }
        }
        document.getElementById('analysis_monthly_bep_volume').value = monthlyBepDisplay;
    }

    // Modal Logic
    const explanations = {
        1: {
            title: "1. ì„ëŒ€ì¡°ê±´ ë° ì˜ˆìƒ ì¶œë ¥ëŸ‰ ìƒì„¸ ì„¤ëª…",
            content: `
                <p><strong>1) ê¸°ê³„ ê°ê°€ìƒê° (ì›”)</strong><br>
                ì…ë ¥í•˜ì‹  ê¸°ê³„ ì›ê°€ë¥¼ ì„ëŒ€ ê¸°ê°„ìœ¼ë¡œ ë‚˜ëˆˆ ë¹„ìš©ì…ë‹ˆë‹¤.<br>
                <code>ê¸°ê³„ì›ê°€ Ã· ì„ëŒ€ê¸°ê°„(ê°œì›”)</code></p>
                <p><strong>2) ì´ ì¶œë ¥ëŸ‰</strong><br>
                ê³„ì•½ ê¸°ê°„ ì „ì²´ ë™ì•ˆ ë°œìƒí•  ì˜ˆìƒ ì¶œë ¥ ë§¤ìˆ˜ì…ë‹ˆë‹¤.<br>
                <code>ì›” ì˜ˆìƒ ì¶œë ¥ëŸ‰ Ã— ì„ëŒ€ê¸°ê°„(ê°œì›”)</code></p>
                <p><strong>3) ì—° ê¸ˆë¦¬</strong><br>
                ê¸°ê³„ êµ¬ë§¤ ìê¸ˆì— ëŒ€í•œ ì´ì ë¹„ìš©ì„ ê³„ì‚°í•  ë•Œ ì‚¬ìš©ë©ë‹ˆë‹¤. (í˜„ì¬ ê¸°ë³¸ê°’ì€ 0%ì…ë‹ˆë‹¤)</p>
            `
        },
        2: {
            title: "2. ì†Œìš”ë¹„ìš© (ì†Œëª¨í’ˆ) ê³„ì‚° ë¡œì§",
            content: `
                <p><strong>1) ì´ ì†Œìš”ê¸ˆì•¡ ê³µì‹</strong><br>
                <code>ë‹¨ê°€(ì„¸íŠ¸) Ã— êµí™˜íšŸìˆ˜</code></p>
                <p><strong>2) êµí™˜íšŸìˆ˜ ê³„ì‚°</strong><br>
                í•„ìš”í•œ ì´ ë‚±ê°œ ìˆ˜ëŸ‰ì„ ì…ë ¥í•˜ì‹  <strong>ê°œìˆ˜(x)</strong>ë¡œ ë‚˜ëˆ„ì–´ ê³„ì‚°í•©ë‹ˆë‹¤.</p>
                <p><strong>3) ë“œëŸ¼ (K/C/M/Y) ë¡œì§</strong><br>
                4ìƒ‰ ê³µìš© ë“œëŸ¼ì˜ ì´ ì‚¬ìš©ëŸ‰ì„ ê³„ì‚°í•©ë‹ˆë‹¤.<br>
                <code>(í‘ë°± ì´ ì¶œë ¥ëŸ‰ + (ì¹¼ë¼ ì´ ì¶œë ¥ëŸ‰ Ã— 3)) Ã· ìˆ˜ëª…</code>ìœ¼ë¡œ í•„ìš”í•œ ë‚±ê°œ ì´ëŸ‰ì„ êµ¬í•œ ë’¤, ì…ë ¥ëœ ê°œìˆ˜(ê¸°ë³¸ 4ê°œ)ë¡œ ë‚˜ëˆ„ì–´ êµí™˜ íšŸìˆ˜ë¥¼ ì‚°ì¶œí•©ë‹ˆë‹¤.</p>
                <p><strong>4) í† ë„ˆ C/M/Y ë¡œì§</strong><br>
                ì¹¼ë¼ ì¶œë ¥ ì‹œ C, M, Y 3ê°€ì§€ í† ë„ˆê°€ ë™ì‹œì— ì†Œëª¨ë˜ë¯€ë¡œ,<br>
                <code>(ì¹¼ë¼ ì´ ì¶œë ¥ëŸ‰ Ã· ìˆ˜ëª…) Ã— 3</code>ìœ¼ë¡œ í•„ìš”í•œ ë‚±ê°œ ì´ëŸ‰ì„ êµ¬í•œ ë’¤, ì…ë ¥ëœ ê°œìˆ˜(ê¸°ë³¸ 3ê°œ)ë¡œ ë‚˜ëˆ„ì–´ êµí™˜ íšŸìˆ˜ë¥¼ ì‚°ì¶œí•©ë‹ˆë‹¤.</p>
            `
        },
        3: {
            title: "3. ì„ëŒ€ì‹œ ì´ìµ (ì›”) ë¶„ì„",
            content: `
                <p><strong>1) ì›ê°€ í•©ê³„ (ì›”)</strong><br>
                ë§¤ì›” ê³ ì •ì ìœ¼ë¡œ ë°œìƒí•˜ëŠ” ë¹„ìš©ì˜ í•©ê³„ì…ë‹ˆë‹¤.<br>
                <code>ì›” ê°ê°€ìƒê°ë¹„ + ì›” ê¸ˆë¦¬ë¹„ìš© + (ì´ ì†Œëª¨í’ˆ ë¹„ìš© Ã· ì„ëŒ€ê¸°ê°„)</code></p>
                <p><strong>2) ì´ìµ (ì›”)</strong><br>
                íšŒì‚¬ì— ë‚¨ëŠ” ì›” ìˆœìˆ˜ìµì…ë‹ˆë‹¤.<br>
                <code>ì›” ì„ëŒ€ ìš”ê¸ˆ - ì›” ì›ê°€ í•©ê³„</code></p>
                <p><strong>3) ë§ˆì§„ìœ¨ (%)</strong><br>
                ë§¤ì¶œ(ì„ëŒ€ë£Œ) ëŒ€ë¹„ ì´ìµì˜ ë¹„ìœ¨ì…ë‹ˆë‹¤.<br>
                <code>(ì›” ì´ìµ Ã· ì›” ì„ëŒ€ ìš”ê¸ˆ) Ã— 100</code></p>
            `
        },
        4: {
            title: "4. ì›ê°€ íšŒìˆ˜ ë‚´ì—­ (ì†ìµë¶„ê¸°ì )",
            content: `
                <p><strong>1) ê¸°ê³„ë¹„ìš©ë§Œ íšŒìˆ˜</strong><br>
                ì„ëŒ€ë£Œ ìˆ˜ìµìœ¼ë¡œ ê¸°ê³„ê°’(ì›ê¸ˆ)ë§Œ ê°šëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.<br>
                <code>ê¸°ê³„ì›ê°€ Ã· ì›” ì„ëŒ€ ìš”ê¸ˆ</code></p>
                <p><strong>2) ê¸°ê³„ + ì†Œëª¨í’ˆ ë¹„ìš© íšŒìˆ˜</strong><br>
                ê¸°ê³„ê°’ê³¼ ê³„ì•½ ê¸°ê°„ ë™ì•ˆ ë°œìƒí•˜ëŠ” ëª¨ë“  ì†Œëª¨í’ˆ ë¹„ìš©ì„ í•©ì¹œ ì´ ì§€ì¶œì„ íšŒìˆ˜í•˜ëŠ” ë° ê±¸ë¦¬ëŠ” ì‹œê°„ì…ë‹ˆë‹¤.<br>
                <code>(ê¸°ê³„ì›ê°€ + ì†Œëª¨í’ˆ ì´ ì†Œìš”ê¸ˆì•¡) Ã· ì›” ì„ëŒ€ ìš”ê¸ˆ</code></p>
            `
        },
        5: {
            title: "5. ë¶„ì„ ë° ì°¸ê³  ì§€í‘œ ìƒì„¸",
            content: `
                <p><strong>1) ì¥ë‹¹ í‰ê·  ì›ê°€ (CPP)</strong><br>
                ì¶œë ¥ 1ì¥ë‹¹ ì‹¤ì œë¡œ ë°œìƒí•˜ëŠ” í‰ê·  ë¹„ìš©ì…ë‹ˆë‹¤.<br>
                <code>ì›” ì›ê°€ í•©ê³„ Ã· ì›” ì´ ì¶œë ¥ëŸ‰</code></p>
                <p><strong>2) ë§¤ì¶œ ëŒ€ë¹„ ì›ê°€ìœ¨</strong><br>
                ì„ëŒ€ë£Œ ë§¤ì¶œ ì¤‘ ì›ê°€ê°€ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ì…ë‹ˆë‹¤.<br>
                <code>(ì›” ì›ê°€ í•©ê³„ Ã· ì›” ì„ëŒ€ë£Œ) Ã— 100</code></p>
                <p><strong>3) ì†ìµë¶„ê¸° ëˆ„ì  ì¶œë ¥ëŸ‰</strong><br>
                íˆ¬ìê¸ˆ(ê¸°ê³„ê°’+ì†Œëª¨í’ˆë¹„)ì„ ëª¨ë‘ íšŒìˆ˜í•˜ëŠ” ì‹œì ì— ë„ë‹¬í•˜ëŠ” ì´ ì¶œë ¥ ë§¤ìˆ˜ì…ë‹ˆë‹¤.<br>
                <code>ì†ìµë¶„ê¸°(ê¸°ê³„+ì†Œëª¨í’ˆ) ê°œì›” ìˆ˜ Ã— ì›” ì´ ì¶œë ¥ëŸ‰</code></p>
                <p><strong>4) ì›” ì†ìµë¶„ê¸° í•œê³„ ì¶œë ¥ëŸ‰ (Limit)</strong><br>
                <span style="color:red; font-weight:bold;">â€» ì˜ˆìƒ ì¶œë ¥ëŸ‰ì´ ì•„ë‹™ë‹ˆë‹¤.</span><br>
                ì…ë ¥í•˜ì‹  <strong>í‘ë°± ëŒ€ ì¹¼ë¼ ì‚¬ìš© ë¹„ìœ¨</strong>ì„ ê¸°ì¤€ìœ¼ë¡œ, ì›” ì„ëŒ€ë£Œ ë‚´ì—ì„œ ë¹„ìš©ì„ ì»¤ë²„í•  ìˆ˜ ìˆëŠ” <strong>ìµœëŒ€ ì¶œë ¥ ë§¤ìˆ˜</strong>ì…ë‹ˆë‹¤.<br>
                ì´ ìˆ˜ì¹˜ë³´ë‹¤ ë” ë§ì´ ì¶œë ¥í•˜ë©´ ì ìê°€ ë°œìƒí•©ë‹ˆë‹¤.</p>
            `
        }
    };

    function openModal(id) {
        document.getElementById('modalHeader').innerHTML = explanations[id].title;
        document.getElementById('modalBody').innerHTML = explanations[id].content;
        document.getElementById('infoModal').style.display = "block";
    }

    function closeModal() {
        document.getElementById('infoModal').style.display = "none";
    }
    
    // ì„¤ì¹˜ ê°€ì´ë“œ ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜ - ì œê±°ë¨
    /* function openInstallModal() {
        document.getElementById('installModal').style.display = "block";
    }

    function closeInstallModal() {
        document.getElementById('installModal').style.display = "none";
    }
    */

    // í™”ë©´ ë°– í´ë¦­ ì‹œ ëª¨ë‹¬ ë‹«ê¸°
    window.onclick = function(event) {
        const infoModal = document.getElementById('infoModal');
        // const installModal = document.getElementById('installModal');
        if (event.target == infoModal) {
            infoModal.style.display = "none";
        }
        /*
        if (event.target == installModal) {
            installModal.style.display = "none";
        }
        */
    }

    // ì´ˆê¸°í™” ë° ì´ë²¤íŠ¸ ë°”ì¸ë”©
    window.onload = function() {
        const keys = ['drumCommon', 'tonerB', 'tonerColor', 'waste', 'fuser'];
        keys.forEach(key => {
            const costEl = document.getElementById('cost_' + key);
            const qtyEl = document.getElementById('qty_' + key);
            if (costEl && qtyEl) {
                const unitPrice = getVal('cost_' + key); 
                costEl.dataset.baseCost = unitPrice; 
                const qty = getQty('qty_' + key); 
                const setPrice = unitPrice * qty; 
                setVal('cost_' + key, setPrice); 
            }
        });

        const inputs = document.querySelectorAll('input[type="text"][inputmode="numeric"], input[type="text"][inputmode="decimal"]');
        inputs.forEach(input => {
            formatInput(input);
        });
        calculate();
    };
</script>

</body>
</html>